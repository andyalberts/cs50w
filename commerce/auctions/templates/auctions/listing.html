{% extends "auctions/layout.html" %}

{% block body %}



<!-- THE CARD -->
    <div class="card col-mb-3 mb-3">

        <!-- LISTING -->
        <h5 class="card-title card-header bg-transparent text-center mb-3">{{ title }} </h5>
        <img src="{{ image }}" class="img-fluid rounded-start w-25" alt="...">
        <div class="card-body">
        <p class="card-text">{{ description }}</p>
        </div>
        <p class="card-text"><small class="text-muted">Start Bid: ${{ start_bid }}</small></p>
        <p class="card-text"><small class="text-muted">Posted by: {{ owner }}</small></p>


        {% if user.is_authenticated %}
        <!-- watchlist -->
        <form action="{% url 'add_rmv_watchlist' id=id %}" method="post">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline-warning">Watchlist</button>
        </form>

        <!-- place bid -->
        <!-- why do I need to use striptags?-->
        {% if bidder|striptags == logged_in.username|striptags %}
            <p>You are latest bidder</p>
        {% elif latest_bidder %}
            Current Bid: {{ bidder }}: {{ bid }}
        {% else %}
            No Current Bids.
        {% endif %}
        <form action="{% url 'bid' id=id %}" method="post">
            {% csrf_token %}
            <div class="input-group col-sm-2 mb-3">
                <span class="input-group-text">$</span>
                <input type="text" class="form-control" name="bid" placeholder="Bid Amount" aria-label="place bid amount">
                <button class="btn btn-outline-secondary" type="submit" id="button-addon2">Place Bid</button>
            </div>
        </form>
        {% endif %}
        <!--Error Message-->
        {% if messages %}
        <ul class="messages">
            {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}

    </div>
<!-- Card End -->


    <!-- comments-->
<form action="{% url 'listing' id=id %}" method="post">
    {% csrf_token %}
    <div class="input-group">
        <textarea class="form-control " name="comment" placeholder="comment"  aria-label="entry textarea" rows="4"></textarea>
    </div>
    <button type="submit">Post Comment</button>
</form>

<!-- deactivate-->
{% if logged_in == owner %}
    <form action="{% url 'toggle_active' id=id %}" method="post">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger active">Deactivate</button>
    </form>
{% endif %}

{% for comment in comments %}
    <li> {{ comment.text }}</li>
    <br>
{% endfor %}
Owner: {{ owner.username }}
<br>
Category: {{ category }}
{% endblock %}

